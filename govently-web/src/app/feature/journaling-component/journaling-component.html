<div class="journal-wrapper d-flex align-items-center justify-content-center">
  

  <div class="journal-card p-4 shadow-lg" [class.burned]="burning">
    <div class="position-sticky top-0" style="z-index: 10;">
  <app-back-button-component></app-back-button-component>
</div>
    
    <!-- Greeting -->
    <div class="text-center mb-4">
      <h1 class="fw-bold">{{ greeting }}</h1>
      <p class="lead text-muted">How are you feeling today?</p>
    </div>

    <!-- Quick Mood Check -->
    <div class="mood-section p-3 mb-4">
      <h4 class="fw-semibold mb-3">Quick Mood Check</h4>
      <div class="mood-selector d-flex justify-content-center gap-3">
        <div *ngFor="let m of moods" 
             class="mood-btn"
             [ngStyle]="{'background-color': m.color, 'border': mood === m.label ? '3px solid white' : 'none'}"
             (click)="mood = m.label"
             title="{{ m.label }}">
          {{ m.emoji }}
        </div>
      </div>
    </div>

    <!-- Today's Reflection -->
    <div class="reflection-section p-3 mb-3">
      <h4 class="fw-semibold d-flex justify-content-center gap-3">
        ðŸ“… Today's Reflection
      </h4>
      <div class="mood-selector d-flex justify-content-center gap-3">
        {{todayPrompt$ | async}}
      </div>
    </div>

    <!-- Journal Input -->
    <textarea class="form-control journal-input" 
              placeholder="Let your thoughts flow freely... There's no judgement here, just space for you to be honest with yourself" 
              [(ngModel)]="entry" 
              rows="8">
    </textarea>

    <!-- Buttons -->
    <div class="text-center mt-4 d-flex justify-content-center gap-3">
      <ng-container *ngIf="todayPrompt$ | async as todayPrompt">
        <button class="btn btn-save px-4 py-3" (click)="saveJournal(todayPrompt)">
          ðŸ’¾ Save & Reflect
        </button>
      </ng-container>
      <button class="btn btn-burn px-4 py-3" (click)="burnEntry()">
        ðŸ”¥ Burn
      </button>
    </div>

     <!-- Previous Reflections Section -->
    <section class="previous-reflections mt-4">
    <h4 class="section-title">
        <i class="bi bi-journal-text me-2"></i> Your Reflections
    </h4>

    <!-- If there are journals -->
    <div class="reflection-list">
        <div class="reflection-card" *ngFor="let entry of pastReflections$ | async" 
             (click)="viewReflection(entry)">
        <div class="reflection-left">
            <span class="mood-icon">{{ entry.mood }}</span>
            <div class="reflection-info">
            <h6 class="reflection-title">{{ entry.prompt }}</h6>
            <small class="text-muted">{{ entry.created_at | date:'mediumDate' }}</small>
            </div>
        </div>
        <i class="bi bi-chevron-right text-muted"></i>
        </div>
    </div>

    <!-- Empty state -->
     <ng-container *ngIf="pastReflections$ | async as pastReflections">
       <div *ngIf="pastReflections.length === 0" class="empty-reflections">
           <img src="assets/empty-journal.svg" alt="No entries" class="empty-img">
           <p class="text-muted">No past reflections yet â€” start your first one today!</p>
       </div>
     </ng-container>
    </section>
  </div>
</div>



